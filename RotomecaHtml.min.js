export{JsHtml};class RotomecaHtml{constructor(t,e,s={}){this.balise=t,this.attribs=s,this.childs=[],this._parent=e}addClass(t){return this.hasClass(t)||this.attribs.class.push(t),this}hasClass(t){return this._update_class().attribs.class.includes(t)}css(t,e=""){if("string"==typeof t)this._update_css().attribs.style[t]||(this.attribs.style[t]=e);else for(const e in t)if(Object.hasOwnProperty.call(t,e)){const s=t[e];this.css(e,s)}return this}parent(){return this._parent}tag(t,e={}){return this._create(t,this,e,!1)}tag_one_line(t,e={}){return this._create_oneline(t,this,e)}a(t={}){return this.tag("a",t)}dd(t={}){return this.tag("dd",t)}dt(t={}){return this.tag("dt",t)}dl(t={}){return this.tag("dl",t)}div(t={}){return this.tag("div",t)}blockquote(t={}){return this.tag("blockquote",t)}ul(t={}){return this.tag("ul",t)}ol(t={}){return this.tag("ol",t)}li(t={}){return this.tag("ul",t)}span(t={}){return this.tag("span",t)}p(t={}){return this.tag("p",t)}img(t={}){return this.tag_one_line("img",t)}style(){return this.tag("style")}style_css_prop(t,e){return this.text(`${t}:${e};`)}_try_add_label(t={}){let e=this;return t?.id&&t?.label&&(e=e.label({for:t.id}).text(t.label).end()),e}input(t={}){return this._try_add_label(t).tag_one_line("input",t)}select(t={}){return this._try_add_label(t).tag("select",t)}option(t={}){return this.tag("option",t)}option_one_line(t,e,s={}){return s.value=t,this.option(s).text(e).end()}textarea(t={}){return this._try_add_label(t).tag("textarea",t)}form(t={}){return this.tag("form",t)}button(t={}){return this.tag("button",t)}fieldset(t={}){return this.tag("fieldset",t)}label(t={}){return this.tag("label",t)}legend(t={}){return this.tag("legend",t)}meter(t={}){return this.tag("meter",t)}optgroup(t={}){return this.tag("optgroup",t)}output(t={}){return this.tag("output",t)}progress(t={}){return this.tag("progress",t)}br(){return this.tag_one_line("br")}hr(){return this.tag_one_line("hr")}address(t={}){return this.tag("address",t)}article(t={}){return this.tag("article",t)}aside(t={}){return this.tag("aside",t)}footer(t={}){return this.tag("footer",t)}header(t={}){return this.tag("header",t)}h(t,e={}){return this.tag(`h${t}`,e)}h1(t={}){return this.h(1,t)}h2(t={}){return this.h(2,t)}h3(t={}){return this.h(3,t)}h4(t={}){return this.h(4,t)}h5(t={}){return this.h(5,t)}h6(t={}){return this.h(6,t)}hgroup(t={}){return this.tag("hgroup",t)}main(t={}){return this.tag("main",t)}nav(t={}){return this.tag("nav",t)}section(t={}){return this.tag("section",t)}menu(t={}){return this.tag("menu",t)}iframe(t={}){return this.tag("iframe",t).end()}canvas(t={}){return this.tag("canvas",t)}script(t={}){return this.tag("script",t)}table(t={}){return this.tag("table",t)}caption(t={}){return this.tag("caption",t)}caption(t={}){return this.tag("caption",t)}col(){return this.tag_one_line("col")}colgroup(t={}){return this.tag("colgroup",t)}tbody(t={}){return this.tag("tbody",t)}td(t={}){return this.tag("td",t)}th(t={}){return this.tag("th",t)}tr(t={}){return this.tag("th",t)}tfoot(t={}){return this.tag("tfoot",t)}tbody(t={}){return this.tag("tbody",t)}details(t={}){return this.tag("details",t)}summary(t={}){return this.tag("summary",t)}dialog(t={}){return this.tag("dialog",t)}comment(t){return this.text(`\x3c!-- ${t} --\x3e`)}_(t){return this}text(t){return this._create(t,this,{is_raw:!0},!0)}end(t=null){let e=this._parent._create(`/${this.balise}`,this._parent,null,!0);return t&&e.text(`\x3c!-- ${t} --\x3e`),e}generate(){return this._generate({mode:1})}generate_html({joli_html:t=!1}){return this._generate({joli_html:t})}_create(t,e,s,r){return this.childs.push(new this.constructor(t,e,s)),r?e:this.childs[this.childs.length-1]}_create_oneline(t,e,s){return this._create(t,e,s,!0)}_update_class(){return this.attribs?this.attribs.class?this.attribs.class&&"string"==typeof this.attribs.class?this.attribs.class=this.attribs.class.split(" "):this.attribs.class&&!this.attribs.class instanceof Array&&(this.attribs.class=[this.attribs.class]):this.attribs.class=[]:this.attribs={class:[]},this}_update_css(){return this.attribs?this.attribs.style||(this.attribs.style={}):this.attribs={style:{}},this}_generate({i:t=-1,mode:e=0,joli_html:s=!1}){let r=[];"start"!==this.balise&&r.push(`${"/textarea"!==this.balise&&s?this._create_blanks(t):""}${this._get_balise()}`);for(const e of this.childs)r.push(e._generate({i:t+1,joli_html:s}));switch(r=r.join(s?"\r\n":""),e){case 0:break;case 1:let t,e;r=$(r);for(const s of r.find("[data-on-id!=''][data-on-id]"))e=$(s),t=e.attr("data-on-id"),e.on(RotomecaHtml.actions[t].action.replace("on",""),RotomecaHtml.actions[t].callback),RotomecaHtml.remove_id(t),t=null,e=null;break;default:throw new Error("mode not exist")}return r}_get_balise(){const t="function"==typeof this.balise?this.balise(this):this.balise;let e;if(!0===this.attribs?.is_raw)e=t;else{if(e=[`<${t}`],"string"==typeof this.attribs)""!==this.attribs&&e.push(this.attribs);else if(this.attribs&&Object.keys(this.attribs).length>0)for(const t in this.attribs)if(Object.hasOwnProperty.call(this.attribs,t)){const i=this.attribs[t];if(!t.includes("on")||t.includes("on")&&"function"!=typeof i)switch(t){case"raw-content":break;case"class":if(i instanceof Array){var s=[];for(const t of i)"function"==typeof t?s.push(t(this)):s.push(t);e.push(`${t}="${s.join(" ")}"`),s.length=0,s=null;break}default:e.push(`${t}="${"function"==typeof i?i(this):i}"`);break}else if(t.includes("on")){var r=RotomecaHtml.generate_ids();e.push(`data-on-id="${r}"`),RotomecaHtml.add_action(r,t,i),r=null}}let i;e.push((!0===this.attribs?.one_line?"/":"")+">"),i=2===e.length?"":" ",this.attribs&&this.attribs["raw-content"]&&e.push("function"==typeof this.attribs["raw-content"]?this.attribs["raw-content"](this):this.attribs["raw-content"]),e=e.join(i)}return e}_create_blanks(t){if(0===t)return"";let e=[];for(let s=0,r=4*t;s<r;++s)e.push(" ");return e.join("")}static start(){return new RotomecaHtml("start",null)}static create_alias(t,{online:e=!1,before_callback:s=null,generate_callback:r=null,after_callback:i=null,tag:a="div"}){return RotomecaHtml.prototype[t]=function(t={},...n){if(s){const e=s(t,...n);e.attribs&&(t=e.attribs)}e&&"object"==typeof t&&(t.one_line=!0);let o=r?r(this,t,...n):this._create(a,this,"object"==typeof t?t:null,e);if(i){const e=i(o,t,...n);e&&e instanceof RotomecaHtml&&(o=e)}return o},this}}RotomecaHtml.actions={},RotomecaHtml.generate_ids=function(t=5){let e="";const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=s.length;let i=0;for(;i<t;)e+=s.charAt(Math.floor(Math.random()*r)),i+=1;return Object.keys(this.actions).includes(e)&&(e=RotomecaHtml.generate_ids(~~(100*Math.random()))),e},RotomecaHtml.remove_id=function(t){RotomecaHtml.actions[t]=null},RotomecaHtml.add_action=function(t,e,s){RotomecaHtml.actions[t]={action:e,callback:s}};const JsHtml={};Object.defineProperties(JsHtml,{start:{get:()=>RotomecaHtml.start(),configurable:!1,enumerable:!1},create_alias:{get:()=>RotomecaHtml.create_alias,configurable:!1,enumerable:!1},extend:{value:function(t,e){RotomecaHtml.prototype[t]=e}},update:{value:function(t,e){const s=RotomecaHtml.prototype[t];RotomecaHtml.prototype[t]=function(...t){return e(this,s,...t)}}}});