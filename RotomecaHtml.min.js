class RotomecaHtml{constructor(t,s,e={}){this.balise=t,this.attribs=e,this.childs=[],this._parent=s}addClass(t){return this.hasClass(t)||this.attribs.class.push(t),this}hasClass(t){return this._update_class().attribs.class.includes(t)}css(t,s=""){if("string"==typeof t)this._update_css().attribs.style[t]||(this.attribs.style[t]=s);else for(const s in t)if(Object.hasOwnProperty.call(t,s)){const e=t[s];this.css(s,e)}return this}parent(){return this._parent}tag(t,s={}){return this._create(t,this,s,!1)}tag_one_line(t,s={}){return this._create_oneline(t,this,s)}a(t={}){return this.tag("a",t)}dd(t={}){return this.tag("dd",t)}dt(t={}){return this.tag("dt",t)}dl(t={}){return this.tag("dl",t)}div(t={}){return this.tag("div",t)}blockquote(t={}){return this.tag("blockquote",t)}ul(t={}){return this.tag("ul",t)}ol(t={}){return this.tag("ol",t)}li(t={}){return this.tag("ul",t)}span(t={}){return this.tag("span",t)}p(t={}){return this.tag("p",t)}img(t,s={}){return s.src=t,this.tag_one_line("img",s)}input(t={}){return this.tag_one_line("input",t)}select(t={}){return this.tag("select",t)}option(t={}){return this.tag("option",t)}option_one_line(t,s,e={}){return e.value=t,this.option(e).text(s).end()}textarea(t={}){return this.tag("textarea",t)}br(){return this.tag_one_line("br")}hr(){return this.tag_one_line("hr")}address(t={}){return this.tag("address",t)}article(t={}){return this.tag("article",t)}aside(t={}){return this.tag("aside",t)}footer(t={}){return this.tag("footer",t)}header(t={}){return this.tag("header",t)}h(t,s={}){return this.tag(`h${t}`,s)}h1(t={}){return this.h(1,t)}h2(t={}){return this.h(2,t)}h3(t={}){return this.h(3,t)}h4(t={}){return this.h(4,t)}h5(t={}){return this.h(5,t)}h6(t={}){return this.h(6,t)}hgroup(t={}){return this.tag("hgroup",t)}main(t={}){return this.tag("main",t)}nav(t={}){return this.tag("nav",t)}section(t={}){return this.tag("section",t)}menu(t={}){return this.tag("menu",t)}iframe(t={}){return this.tag("iframe",t).end()}canvas(t={}){return this.tag("canvas",t)}script(t={}){return this.tag("script",t)}table(t={}){return this.tag("table",t)}caption(t={}){return this.tag("caption",t)}caption(t={}){return this.tag("caption",t)}col(){return this.tag_one_line("col")}colgroup(t={}){return this.tag("colgroup",t)}tbody(t={}){return this.tag("tbody",t)}td(t={}){return this.tag("td",t)}th(t={}){return this.tag("th",t)}tr(t={}){return this.tag("th",t)}tfoot(t={}){return this.tag("tfoot",t)}tbody(t={}){return this.tag("tbody",t)}details(t={}){return this.tag("details",t)}summary(t={}){return this.tag("summary",t)}dialog(t={}){return this.tag("dialog",t)}comment(t){return this.text(`\x3c!-- ${t} --\x3e`)}_(t){return this}text(t){return this._create(t,this,{is_raw:!0},!0)}end(t=null){let s=this._parent._create(`/${this.balise}`,this._parent,null,!0);return t&&s.text(`\x3c!-- ${t} --\x3e`),s}generate(){return this._generate({mode:1})}generate_html({joli_html:t=!1}){return this._generate({joli_html:t})}_create(t,s,e,i){return this.childs.push(new this.constructor(t,s,e)),i?s:this.childs[this.childs.length-1]}_create_oneline(t,s,e){return this._create(t,s,e,!0)}_update_class(){return this.attribs?this.attribs.class?this.attribs.class&&"string"==typeof this.attribs.class?this.attribs.class=this.attribs.class.split(" "):this.attribs.class&&!this.attribs.class instanceof Array&&(this.attribs.class=[this.attribs.class]):this.attribs.class=[]:this.attribs={class:[]},this}_update_css(){return this.attribs?this.attribs.style||(this.attribs.style={}):this.attribs={style:{}},this}_generate({i:t=-1,mode:s=0,joli_html:e=!1}){let i=[];"start"!==this.balise&&i.push(`${"/textarea"!==this.balise&&e?this._create_blanks(t):""}${this._get_balise()}`);for(const s of this.childs)i.push(s._generate({i:t+1,joli_html:e}));switch(i=i.join(e?"\r\n":""),s){case 0:break;case 1:let t,s;i=$(i);for(const e of i.find("[data-on-id!=''][data-on-id]"))s=$(e),t=s.attr("data-on-id"),s.on(RotomecaHtml.actions[t].action.replace("on",""),RotomecaHtml.actions[t].callback),RotomecaHtml.remove_id(t),t=null,s=null;break;default:throw new Error("mode not exist")}return i}_get_balise(){const t="function"==typeof this.balise?this.balise(this):this.balise;let s;if(!0===this.attribs?.is_raw)s=t;else{if(s=[`<${t}`],"string"==typeof this.attribs)""!==this.attribs&&s.push(this.attribs);else if(this.attribs&&Object.keys(this.attribs).length>0)for(const t in this.attribs)if(Object.hasOwnProperty.call(this.attribs,t)){const r=this.attribs[t];if(!t.includes("on")||t.includes("on")&&"function"!=typeof r)switch(t){case"raw-content":break;case"class":if(r instanceof Array){var e=[];for(const t of r)"function"==typeof t?e.push(t(this)):e.push(t);s.push(`${t}="${e}"`),e.length=0,e=null;break}default:s.push(`${t}="${"function"==typeof r?r(this):r}"`);break}else if(t.includes("on")){var i=RotomecaHtml.generate_ids();s.push(`data-on-id="${i}"`),RotomecaHtml.add_action(i,t,r),i=null}}let r;s.push((!0===this.attribs?.one_line?"/":"")+">"),r=2===s.length?"":" ",this.attribs&&this.attribs["raw-content"]&&s.push("function"==typeof this.attribs["raw-content"]?this.attribs["raw-content"](this):this.attribs["raw-content"]),s=s.join(r)}return s}_create_blanks(t){if(0===t)return"";let s=[];for(let e=0,i=4*t;e<i;++e)s.push(" ");return s.join("")}static start(){return new RotomecaHtml("start",null)}static create_alias(t,{online:s=!1,before_callback:e=null,callback:i=null,tag:r="div"}){return RotomecaHtml.prototype[t]=function(t={},...a){if(e){const s=e(t,...a);s.attribs&&(t=s.attribs)}s&&"object"==typeof t&&(t.one_line=!0);let n=this._create(r,this,"object"==typeof t?t:null,s);if(i){const s=i(n,t,...a);s&&s instanceof RotomecaHtml&&(n=s)}return n},this}}RotomecaHtml.actions={},RotomecaHtml.generate_ids=function(t=5){let s="";const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=e.length;let r=0;for(;r<t;)s+=e.charAt(Math.floor(Math.random()*i)),r+=1;return Object.keys(this.actions).includes(s)&&(s=RotomecaHtml.generate_ids(~~(100*Math.random()))),s},RotomecaHtml.remove_id=function(t){RotomecaHtml.actions[t]=null},RotomecaHtml.add_action=function(t,s,e){RotomecaHtml.actions[t]={action:s,callback:e}};